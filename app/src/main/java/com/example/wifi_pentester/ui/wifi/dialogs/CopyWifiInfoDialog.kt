package com.example.wifi_pentester.ui.wifi.dialogs

import android.app.Dialog
import android.content.ClipData
import android.content.ClipboardManager
import android.content.Context
import android.os.Bundle
import android.widget.Toast
import androidx.databinding.DataBindingUtil.inflate
import com.example.wfc_models.wifi.scanners.data_models.Wifi
import com.example.wifi_pentester.R
import com.example.wifi_pentester.databinding.CopyWifiInfoDialogBinding
import com.example.wifi_pentester.utils.diallogs.DialogWithParcelableDataBase
import com.google.android.material.chip.Chip

class CopyWifiInfoDialog : DialogWithParcelableDataBase<Wifi>() {
    override val dataKey: String = "dataKey_${this.javaClass.name}"
    override val dialogTag: String = this.javaClass.name

    override fun onCreateDialog(savedInstanceState: Bundle?): Dialog {
        val dialogBinding: CopyWifiInfoDialogBinding =
            inflate(layoutInflater, R.layout.copy_wifi_info_dialog, null, false)

        dialogBinding.wifi = parcelableData

        dialogBinding.copyInfoDialCopyButton.setOnClickListener {
            copyInfoDialCopyButtonClick(dialogBinding)
        }

        return onCreateDialog(dialogBinding.root)
    }

    private fun copyInfoDialCopyButtonClick(dialogBinding: CopyWifiInfoDialogBinding) {
        val chipGroup = dialogBinding.copyChipGroup
        val selectedChip:Chip = chipGroup.findViewById(chipGroup.checkedChipId)

        val clipboard = requireContext().getSystemService(Context.CLIPBOARD_SERVICE) as ClipboardManager
        val clip = ClipData.newPlainText("", selectedChip.text.toString())
        clipboard.setPrimaryClip(clip)
        Toast.makeText(context,"Copied ${selectedChip.text}", Toast.LENGTH_SHORT).show()
    }
}